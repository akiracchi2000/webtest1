<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>

  <title>è¨ˆç®—ãƒ†ã‚¹ãƒˆ (ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆA)</title>

  <!-- KaTeX -->
  <link rel="stylesheet" href="./katex/katex.min.css" />
  <script defer src="./katex/katex.min.js"></script>
  <script defer src="./katex/contrib/auto-render.min.js"></script>

  <style>
    /* ãƒšãƒ¼ã‚¸ã®åŸºæœ¬ã‚¹ã‚¿ã‚¤ãƒ« */
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      margin: 0;
      background-color: #f4f7f6;
      transition: background-color 0.5s ease;
    }
    body.timer-warning { background-color: #ffebee; }

    /* ===== ãƒ¢ãƒ¼ãƒ‰é¸æŠç”»é¢ã®ã‚¹ã‚¿ã‚¤ãƒ« ===== */
    #mode-selection {
      text-align: center;
      background: #fff;
      padding: 3em;
      border-radius: 12px;
      box-shadow: 0 6px 20px rgba(0,0,0,0.08);
    }
    #mode-selection h1 { color: #2c3e50; margin-top: 0; }
    .mode-buttons { display: flex; flex-direction: column; gap: 1em; }
    .mode-btn {
      padding: 15px 30px; font-size: 1.2em; border: none; border-radius: 8px;
      cursor: pointer; transition: transform 0.2s, box-shadow 0.2s; color: #fff; font-weight: bold;
    }
    .mode-btn:hover { transform: translateY(-3px); box-shadow: 0 4px 15px rgba(0,0,0,0.1); }
    #normal-mode-btn { background-color: #3498db; }
    #musou-mode-btn  { background-color: #c0392b; }

    /* ===== ç„¡åŒãƒ¢ãƒ¼ãƒ‰ç”¨ã®èƒŒæ™¯ç”»åƒ ===== */
    #musou-background {
      position: fixed; inset: 0;
      background-image: url('./hannya.png'); background-repeat: repeat;
      background-size: 100px; background-position: center; opacity: 0.15; z-index: -1;
    }

    /* ã‚¯ã‚¤ã‚ºå…¨ä½“ã®ã‚³ãƒ³ãƒ†ãƒŠ */
    .quiz-container {
      max-width: 600px; width: 90%; background: #fff; padding: 2em; border-radius: 12px;
      box-shadow: 0 6px 20px rgba(0,0,0,0.08);
    }

    .timer-container {
      position: relative; width: 100%; height: 25px; background-color: #e9ecef;
      border-radius: 15px; margin-bottom: 1.5em; overflow: hidden;
    }
    .timer-bar { height: 100%; width: 100%; background-color: #3498db; border-radius: 15px; transition: width 1s linear, background-color 0.5s ease; }
    .timer-bar.warning { background-color: #dc3545; }
    .timer-text { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); color: #fff; font-weight: bold; }

    h1 {
      color: #2c3e50; text-align: center; border-bottom: 2px solid #3498db;
      padding-bottom: 10px; margin: 0 0 1em 0;
    }

    /* å•é¡Œæ–‡ */
    .problem-text {
      font-size: 1.7em;
      margin-bottom: 1em;
      text-align: center;
      min-height: 50px;
      overflow-x: auto;
      -webkit-overflow-scrolling: touch;
    }

    /* ã‚¹ãƒãƒ›ã§ã¯ã¿å‡ºã™æ•°å¼å¯¾ç­–ï¼ˆæ¨ªã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ï¼†æœ€å¤§å¹…ï¼‰ */
    .problem-text,
    .calculation-process,
    .katex-display {
      overflow-x: auto;
      -webkit-overflow-scrolling: touch;
    }
    .katex-display > .katex {
      display: inline-block;
      max-width: 100%;
    }
    @media (max-width: 640px) {
      .problem-text { font-size: clamp(18px, 6vw, 28px); }
      .choices .choice { font-size: clamp(14px, 4.2vw, 18px); }
    }

    /* é¸æŠè‚¢ */
    .choices { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
    .choice {
      display: block; background: #e9ecef; padding: 15px; border-radius: 8px; text-align: center;
      cursor: pointer; transition: background-color 0.2s, transform 0.2s; border: 2px solid transparent; font-size: 1.2em;
    }
    .choice:hover { background-color: #d1d9e0; }
    .choice.correct { background-color: #d4edda !important; border-color: #c3e6cb !important; color: #155724; font-weight: bold; }
    .choice.incorrect { background-color: #f8d7da !important; border-color: #f5c6cb !important; color: #721c24; }
    .choices.answered { pointer-events: none; }
    .choices.answered .choice:not(.correct):not(.incorrect) { opacity: 0.6; }

    /* ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ï¼†è§£èª¬ */
    .feedback-area { margin-top: 1.5em; min-height: 150px; }
    .feedback-message { font-size: 2.5em; font-weight: bold; text-align: center; margin: 0 0 15px 0; }
    .feedback-message.correct-feedback { color: #28a745; }
    .feedback-message.incorrect-feedback { color: #dc3545; }
    .calculation-process {
      background-color: #f8f9fa; border-radius: 5px; padding: 15px; font-size: 1.1em; border-left: 5px solid #6c757d;
      text-align: left; /* è§£èª¬ãƒ–ãƒ­ãƒƒã‚¯ã¯å·¦å¯„ã› */
    }
    .calculation-process .katex-display { text-align: left !important; }
    .calculation-process .katex-display > .katex { display: inline-block; max-width: 100%; }

    .controls { text-align: center; margin-top: 1em; height: 50px; }
    #next-btn { padding: 12px 35px; font-size: 1.1em; color: #fff; background-color: #3498db; border: none; border-radius: 5px; cursor: pointer; transition: background-color 0.3s; }
    #next-btn:hover { background-color: #2980b9; }

    /* çµæœ */
    #results { text-align: center; }
    #results h2 { color: #2c3e50; }
    #results #score { font-size: 2em; font-weight: bold; color: #3498db; margin: 0.5em 0; }
    #results #time-info { font-size: 1.2em; color: #6c757d; margin: 0.5em 0; }
    #results #rank-info { font-size: 2.5em; font-weight: bold; margin: 0.5em 0; }
    #results .sub-message { font-size: 1em; color: #6c757d; margin-top: 0.5em; }
    .trophy-message { font-size: 1.8em; font-weight: bold; color: #e74c3c; margin: 0.5em 0; min-height: 1.2em; }

    .hidden { display: none; }

    /* ãƒˆãƒƒãƒ—ã¸æˆ»ã‚‹ */
    .home-btn {
      display: inline-block; margin-top: 1.5em; padding: 10px 25px; font-size: 1em; text-decoration: none;
      color: #fff; background-color: #6c757d; border-radius: 5px; transition: background-color 0.2s;
    }
    .home-btn:hover { background-color: #5a6268; }

    /* å•é¡Œæ–‡ã‚’å·¦å¯„ã›ã«ã™ã‚‹ */
.problem-text {
  text-align: left !important;
}

/* ãƒ‡ã‚£ã‚¹ãƒ—ãƒ¬ã‚¤æ•°å¼ï¼ˆ$$â€¦$$ ç­‰ï¼‰ã‚‚å·¦å¯„ã› */
.problem-text .katex-display {
  text-align: left !important;
}
.problem-text .katex-display > .katex {
  display: inline-block;
  max-width: 100%;
}

  </style>
</head>
<body>

  <div id="mode-selection">
    <h1>ãƒ¢ãƒ¼ãƒ‰ã‚’é¸æŠ</h1>
    <div class="mode-buttons">
      <button id="normal-mode-btn" class="mode-btn">âœ’ï¸ãƒãƒ¼ãƒãƒ«ãƒ¢ãƒ¼ãƒ‰âœ’ï¸</button>
      <button id="musou-mode-btn" class="mode-btn">âš”ï¸ç„¡åŒãƒ¢ãƒ¼ãƒ‰âš”ï¸</button>
    </div>
    <a href="./index.html" class="home-btn" style="margin-top: 2em;">ãƒˆãƒƒãƒ—ãƒšãƒ¼ã‚¸ã«æˆ»ã‚‹</a>
  </div>

  <div class="quiz-container hidden" id="quiz-main">
    <div class="timer-container">
      <div class="timer-bar" id="timer-bar"></div>
      <span class="timer-text" id="timer-text"></span>
    </div>

    <h1>æ¯”ä¾‹ã¨åæ¯”ä¾‹ (åˆç´š)</h1>
    <div id="question-area"></div>

    <div id="results" class="hidden">
      <h2>ãƒ†ã‚¹ãƒˆçµ‚äº†ï¼</h2>
      <p id="score"></p>
      <p id="time-info"></p>
      <p id="rank-info"></p>
      <p id="trophy-message" class="trophy-message"></p>
      <p class="sub-message">ãŠç–²ã‚Œæ§˜ã§ã—ãŸï¼</p>
      <a href="./index.html" class="home-btn">ãƒˆãƒƒãƒ—ãƒšãƒ¼ã‚¸ã«æˆ»ã‚‹</a>
    </div>

    <div class="controls">
      <button id="next-btn" class="hidden">æ¬¡ã®å•é¡Œã¸</button>
    </div>
  </div>

  <div id="musou-background" class="hidden"></div>

  <script>
    // ===== å…¨100å•ã®å•é¡Œãƒ‡ãƒ¼ã‚¿ãƒãƒ³ã‚¯ (æ¯”ä¾‹ãƒ»åæ¯”ä¾‹ v1) =====
    const fullQuizDataBank = [
      {
        question:
          "$y$ã¯$x$ã«æ¯”ä¾‹ã—ã€å¯¾å¿œã™ã‚‹$x, y$ã®å€¤ãŒè¡¨ã®ã‚ˆã†ã«ãªã£ã¦ã„ã‚‹ã€‚è¡¨ã®$A$ã«ã‚ã¦ã¯ã¾ã‚‹æ•°ã‚’æ±‚ã‚ãªã•ã„ã€‚"+
          "$$\\begin{array}{c|c|c|c|c|c}" +
          "x & \\cdots & -2 & \\cdots & 4 & \\cdots \\\\ \\hline " +
          "y & \\cdots & 8 & \\cdots & A & \\cdots" +
          "\\end{array}$$",
        choices: ["$-16$", "$16$", "$-8$", "$8$"],
        answer: "$-16$",
        process:
            "\\begin{aligned}" +
            "y & = ax\\\\ " +
            "x=-2,\\; y=8\\; ã‚ˆã‚Š\\; 8 & = a\\times(-2)\\; \\text{ã ã‹ã‚‰}\\; a=-4\\\\ " +
            "y & = -4x\\\\ " +
            "x=4\\; ã‚’ä»£å…¥ã—ã¦ã€\\; y & = -4\\times 4 = -16\\\\ " +
            "A & = -16" +
            "\\end{aligned}"
       }
       ];

    // ===== ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•°å®šç¾© =====
    const modeSelectionScreen = document.getElementById('mode-selection');
    const quizMainScreen = document.getElementById('quiz-main');
    const musouBackground = document.getElementById('musou-background');

    const questionArea = document.getElementById('question-area');
    const nextButton = document.getElementById('next-btn');
    const resultsArea = document.getElementById('results');
    const scoreDisplay = document.getElementById('score');
    const timerBar = document.getElementById('timer-bar');
    const timerText = document.getElementById('timer-text');

    let selectedQuizData;
    let currentQuestionIndex = 0;
    let score = 0;
    let currentMode = 'normal'; // ç¾åœ¨ã®ãƒ¢ãƒ¼ãƒ‰ã‚’ä¿å­˜

    let timerInterval;
    let timeLeft;
    let TIME_LIMIT;
    let WARNING_TIME;

    let totalSolveTime = 0;
    let questionStartTime;

    let currentRankSettings = {}; // ãƒ©ãƒ³ã‚¯åˆ¤å®šåŸºæº–ã‚’ä¿å­˜

    // ===== ãƒ¢ãƒ¼ãƒ‰é¸æŠã¨ã‚¯ã‚¤ã‚ºé–‹å§‹ =====
    document.getElementById('normal-mode-btn').addEventListener('click', () => {
      startGame({
        mode: 'normal',
        timeLimit: 15, warningTime: 5, isMusou: false,
        sRankTime: 40, aRankTime: 60, bRankTime: 90
      });
    });

    document.getElementById('musou-mode-btn').addEventListener('click', () => {
      startGame({
        mode: 'musou',
        timeLimit: 7, warningTime: 3, isMusou: true,
        sRankTime: 30, aRankTime: 45, bRankTime: 60
      });
    });

    function startGame(settings) {
      currentMode = settings.mode;
      TIME_LIMIT = settings.timeLimit;
      WARNING_TIME = settings.warningTime;

      currentRankSettings = {
        sRankTime: settings.sRankTime,
        aRankTime: settings.aRankTime,
        bRankTime: settings.bRankTime
      };

      if (settings.isMusou) musouBackground.classList.remove('hidden');

      function shuffleArray(array) {
        const a = [...array];
        for (let i = a.length - 1; i > 0; i--) {
          const j = Math.floor(Math.random() * (i + 1));
          [a[i], a[j]] = [a[j], a[i]];
        }
        return a;
      }
      const shuffledData = shuffleArray(fullQuizDataBank);
      selectedQuizData = shuffledData.slice(0, 10);

      modeSelectionScreen.classList.add('hidden');
      quizMainScreen.classList.remove('hidden');

      showQuestion();
    }

    // ===== ã‚¿ã‚¤ãƒãƒ¼ =====
    function startTimer() {
      timeLeft = TIME_LIMIT;
      timerText.textContent = timeLeft;
      timerBar.style.width = '100%';
      timerBar.classList.remove('warning');
      document.body.classList.remove('timer-warning');

      timerInterval = setInterval(() => {
        timeLeft--;
        timerText.textContent = timeLeft;
        timerBar.style.width = (timeLeft / TIME_LIMIT) * 100 + '%';

        if (timeLeft <= WARNING_TIME) {
          timerBar.classList.add('warning');
          document.body.classList.add('timer-warning');
        }
        if (timeLeft <= 0) timeUp();
      }, 1000);
    }
    function stopTimer() { clearInterval(timerInterval); }

    function timeUp() {
      stopTimer();
      totalSolveTime += TIME_LIMIT;

      const choicesContainer = questionArea.querySelector('.choices');
      const feedbackMessage = document.getElementById('feedback-message');
      const processDisplay = document.getElementById('calculation-process');
      const currentQuestion = selectedQuizData[currentQuestionIndex];
      const correctAnswer = currentQuestion.answer.replace(/\$/g, '');

      if (choicesContainer) choicesContainer.classList.add('answered');

      feedbackMessage.textContent = "æ™‚é–“åˆ‡ã‚ŒğŸ’¦";
      feedbackMessage.classList.add('incorrect-feedback');
      feedbackMessage.classList.remove('hidden');

      // è§£èª¬ï¼ˆæ™‚é–“åˆ‡ã‚Œè¡¨ç¤ºï¼‰
      katex.render(currentQuestion.process, processDisplay, { throwOnError: false, displayMode: true });
      processDisplay.classList.remove('hidden');

      Array.from(choicesContainer.children).forEach(child => {
        const choiceText = child.textContent.replace(/\$/g, '');
        if (choiceText === correctAnswer) child.classList.add('correct');
      });

      nextButton.innerText = (currentQuestionIndex < selectedQuizData.length - 1) ? "æ¬¡ã®å•é¡Œã¸" : "çµæœã‚’è¦‹ã‚‹";
      nextButton.classList.remove('hidden');
    }

    // ===== KaTeX æ··åœ¨ãƒ†ã‚­ã‚¹ãƒˆå¯¾å¿œãƒ˜ãƒ«ãƒ‘ =====
    function renderInlineMathIn(rootEl){
      if (!window.renderMathInElement) { console.warn('auto-render not ready'); return; }
      renderMathInElement(rootEl, {
        delimiters: [
          { left: '$$', right: '$$', display: true },
          { left: '\\[', right: '\\]', display: true },
          { left: '$',  right: '$',  display: false },
          { left: '\\(', right: '\\)', display: false }
        ],
        throwOnError: false
      });
    }

    // ç´”ç²‹æ•°å¼ãƒ–ãƒ­ãƒƒã‚¯ã‹ã®ç°¡æ˜“åˆ¤å®š
    function isPureMathBlock(str) {
      const s = (str || '').trim();
      return s.startsWith('$$') || s.startsWith('\\[') || s.startsWith('\\(') || s.startsWith('\\begin{');
    }

    // onclick å¼•æ•°ç”¨ã®æœ€ä½é™ã‚¨ã‚¹ã‚±ãƒ¼ãƒ—
    function escapeForOnclick(raw) {
      return raw.replace(/\\/g, '\\\\').replace(/'/g, "\\'");
    }

    // ====== å•é¡Œè¡¨ç¤ºï¼ˆæ—¥æœ¬èªï¼‹æ•°å¼ã®æ··åœ¨ã«å¯¾å¿œï¼‰======
    function showQuestion() {
      const currentQuestion = selectedQuizData[currentQuestionIndex];

      // é¸æŠè‚¢HTML
      const choicesHtml = currentQuestion.choices.map(choice => {
        const rawForCompare = choice.replace(/\$/g, '');
        const safe = escapeForOnclick(rawForCompare);
        return `<div class="choice" onclick="selectAnswer(this, '${safe}')">${choice}</div>`;
      }).join('');

      // ç”»é¢çµ„ã¿ç«‹ã¦
      questionArea.innerHTML = `
        <div class="question-block">
          <div class="problem-text" id="problem-text"></div>
          <div class="choices">${choicesHtml}</div>
          <div class="feedback-area">
            <p id="feedback-message" class="hidden"></p>
            <div id="calculation-process" class="calculation-process hidden"></div>
          </div>
        </div>
      `;

      // å•é¡Œæ–‡ï¼šHTML â†’ auto-render
      const problemTextElement = document.getElementById('problem-text');
      problemTextElement.innerHTML = currentQuestion.question;
      renderInlineMathIn(problemTextElement);

      // é¸æŠè‚¢ï¼šauto-render
      const choicesContainer = questionArea.querySelector('.choices');
      renderInlineMathIn(choicesContainer);

      // è§£èª¬ï¼šç´”æ•°å¼ã¯ katex.renderã€æ··åœ¨ã¯ auto-render
      const processDisplay = document.getElementById('calculation-process');
      const proc = currentQuestion.process || '';
      processDisplay.innerHTML = '';
      if (isPureMathBlock(proc)) {
        try {
          katex.render(proc, processDisplay, { throwOnError: false, displayMode: true });
        } catch {
          processDisplay.textContent = proc;
          renderInlineMathIn(processDisplay);
        }
      } else {
        processDisplay.textContent = proc;
        renderInlineMathIn(processDisplay);
      }

      // ã‚¿ã‚¤ãƒãƒ¼é–‹å§‹
      questionStartTime = Date.now();
      startTimer();
    }

    function selectAnswer(element, selectedChoice) {
      stopTimer();
      const timeTaken = (Date.now() - questionStartTime) / 1000;
      totalSolveTime += timeTaken;

      const choicesContainer = element.parentElement;
      if (choicesContainer.classList.contains('answered')) return;
      choicesContainer.classList.add('answered');

      const currentQuestion = selectedQuizData[currentQuestionIndex];
      const correctAnswer = currentQuestion.answer.replace(/\$/g, '');

      const feedbackMessage = document.getElementById('feedback-message');
      const processDisplay = document.getElementById('calculation-process');

      if (selectedChoice === correctAnswer) {
        score++;
        element.classList.add('correct');
        feedbackMessage.textContent = "æ­£è§£ğŸ’";
        feedbackMessage.classList.add('correct-feedback');
      } else {
        element.classList.add('incorrect');
        feedbackMessage.textContent = "ä¸æ­£è§£ğŸ’¦";
        feedbackMessage.classList.add('incorrect-feedback');

        // è§£èª¬ï¼ˆä¸æ­£è§£æ™‚è¡¨ç¤ºï¼‰
        katex.render(currentQuestion.process, processDisplay, { throwOnError: false, displayMode: true });
        processDisplay.classList.remove('hidden');

        // æ­£è§£ã®é¸æŠè‚¢ã‚’ãƒã‚¤ãƒ©ã‚¤ãƒˆ
        Array.from(choicesContainer.children).forEach(child => {
          const choiceText = child.textContent.replace(/\$/g, '');
          if (choiceText === correctAnswer) child.classList.add('correct');
        });
      }

      feedbackMessage.classList.remove('hidden');

      nextButton.innerText = (currentQuestionIndex < selectedQuizData.length - 1) ? "æ¬¡ã®å•é¡Œã¸" : "çµæœã‚’è¦‹ã‚‹";
      nextButton.classList.remove('hidden');
    }

    nextButton.addEventListener('click', () => {
      currentQuestionIndex++;
      document.body.classList.remove('timer-warning');
      if (currentQuestionIndex < selectedQuizData.length) {
        showQuestion();
        nextButton.classList.add('hidden');
      } else {
        showResults();
      }
    });

    function showResults() {
      questionArea.classList.add('hidden');
      nextButton.classList.add('hidden');
      document.querySelector('.timer-container').classList.add('hidden');

      const finalScore = score * 10;
      const totalPoints = selectedQuizData.length * 10;
      const totalSeconds = Math.round(totalSolveTime);

      let rank = '', rankColor = '', rankName = '';
      if (totalSeconds <= currentRankSettings.sRankTime) {
        rank = 'â­ï¸ Sãƒ©ãƒ³ã‚¯ â­ï¸'; rankColor = '#ffc107'; rankName = 'S';
      } else if (totalSeconds <= currentRankSettings.aRankTime) {
        rank = 'ğŸŒ› Aãƒ©ãƒ³ã‚¯ ğŸŒ›'; rankColor = '#6c757d'; rankName = 'A';
      } else if (totalSeconds <= currentRankSettings.bRankTime) {
        rank = 'ğŸŒ² Bãƒ©ãƒ³ã‚¯ ğŸŒ²'; rankColor = '#cd7f32'; rankName = 'B';
      } else {
        rank = 'ğŸ’ª Cãƒ©ãƒ³ã‚¯ ğŸ’ª'; rankColor = '#28a745'; rankName = 'C';
      }

      // â˜… é”æˆçŠ¶æ³ ä¿å­˜
      const thisTestId = "test11";
      const historyKey = 'algebraHistory';
      let achievements = JSON.parse(localStorage.getItem('quizAchievements')) || {};
      const currentBest = achievements[thisTestId];
      let newLevel = '';
      let shouldUpdate = false;
      let trophyMessage = '';

      if (finalScore === totalPoints) {
        if (rankName === 'S' || rankName === 'A') newLevel = (currentMode === 'musou') ? 'musou' : 'normal';
        else newLevel = 'apple';

        if (newLevel === 'musou') shouldUpdate = true;
        else if (newLevel === 'normal' && (currentBest !== 'musou')) shouldUpdate = true;
        else if (newLevel === 'apple' && (currentBest !== 'musou' && currentBest !== 'normal')) shouldUpdate = true;

        if (shouldUpdate) {
          achievements[thisTestId] = newLevel;
          localStorage.setItem('quizAchievements', JSON.stringify(achievements));
          if (newLevel === 'musou') trophyMessage = 'ğŸ‘‘ã‚’ã‚²ãƒƒãƒˆã—ã¾ã—ãŸï¼';
          else if (newLevel === 'normal') trophyMessage = 'â­ã‚’ã‚²ãƒƒãƒˆã—ã¾ã—ãŸï¼';
          else if (newLevel === 'apple') trophyMessage = 'ğŸã‚’ã‚²ãƒƒãƒˆã—ã¾ã—ãŸï¼';
        }
      }

      // å±¥æ­´ä¿å­˜
      const newResult = {
        score: finalScore, totalPoints: totalPoints, time: totalSeconds,
        rank: rankName, date: new Date().toLocaleString('ja-JP')
      };
      let history = JSON.parse(localStorage.getItem(historyKey)) || [];
      history.unshift(newResult);
      localStorage.setItem(historyKey, JSON.stringify(history));

      // è¡¨ç¤º
      resultsArea.classList.remove('hidden');
      const timeInfoDisplay = document.getElementById('time-info');
      const rankInfoDisplay = document.getElementById('rank-info');
      const trophyDisplay = document.getElementById('trophy-message');

      scoreDisplay.textContent = `${finalScore}ç‚¹ / ${totalPoints}ç‚¹æº€ç‚¹`;
      timeInfoDisplay.textContent = `åˆè¨ˆè§£ç­”æ™‚é–“: ${totalSeconds}ç§’`;
      rankInfoDisplay.textContent = rank;
      rankInfoDisplay.style.color = rankColor;
      trophyDisplay.textContent = trophyMessage;
    }
  </script>
</body>
</html>
